# .htaccess to hide .php extensions
# - Redirect requests with .php in the URL to the extensionless URL (301)
# - Internally rewrite extensionless URLs to their .php files if they exist
# Requirements: Apache with mod_rewrite enabled and AllowOverride All for this directory

<IfModule mod_rewrite.c>
  RewriteEngine On

  # Avoid processing existing files or directories
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Redirect direct requests to *.php to extensionless URLs to avoid duplicate content
  # Example: GET /foo.php -> 301 /foo
  RewriteCond %{THE_REQUEST} \s/([^\s]+?)\.php[\s?] [NC]
  RewriteRule ^ /%1 [R=301,L]

  # If the request doesn't map to a real file/dir but a .php file exists, serve it internally
  # Example: request /foo -> serve /foo.php if it exists
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME}.php -f
  RewriteRule ^(.*)$ $1.php [L]

</IfModule>

# Recommended DirectoryIndex
DirectoryIndex index.php index.html
